<main class="chat-app">
  <header class="header">
    <h1 class="channel-title">{{slug}}</h1>
    <a href="https://github.com/doramatadora/passwordless-demo" target="_blank" class="code-button"
      aria-label="View source code on GitHub">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 -960 960 960">
        <path
          d="m384-336 56-57-87-87 87-87-56-57-144 144 144 144Zm192 0 144-144-144-144-56 57 87 87-87 87 56 57ZM200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Zm0-560v560-560Z" />
      </svg>
    </a>
  </header>
  <section class="chat-area" id="chat">
    {{#ifeq firstMsgShownId firstMsgId}}{{else}}
    <button id="load-more" class="load-more-button" aria-label="Load more">
      <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24">
        <path
          d="M240-400q-33 0-56.5-23.5T160-480q0-33 23.5-56.5T240-560q33 0 56.5 23.5T320-480q0 33-23.5 56.5T240-400Zm240 0q-33 0-56.5-23.5T400-480q0-33 23.5-56.5T480-560q33 0 56.5 23.5T560-480q0 33-23.5 56.5T480-400Zm240 0q-33 0-56.5-23.5T640-480q0-33 23.5-56.5T720-560q33 0 56.5 23.5T800-480q0 33-23.5 56.5T720-400Z" />
      </svg>
    </button>
    {{/ifeq}}
    {{#each messages}}
    <div class="chat {{#ifeq user ../currentUser}}sent{{else}}received{{/ifeq}}" data-id="{{id}}">
      <div class="msg-info">
        <div class="msg-from">{{user}}</div>
        {{#ifeq user ../currentUser}}<button class="msg-delete"></button>{{/ifeq}}
      </div>
      <div class="message">{{{message}}}</div>

        <div class="timestamp" data-ts="{{date_sent}}">{{relTime}}</div>
    </div>
    {{/each}}
    <button id="scroll-to-bottom" class="scroll-button" aria-label="Scroll to bottom">
      <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24">
        <path
          d="m480-340 180-180-57-56-123 123-123-123-57 56 180 180Zm0 260q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-320Z" />
      </svg>
    </button>
  </section>
  <footer class="footer">
    <div class="text-entry-container">
      <textarea class="text-entry" id="msg-input" autocomplete="off" placeholder="Type a message..."
        maxlength="500"></textarea>
    </div>
    <button class="send-button" id="msg-send"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
        viewBox="0 -960 960 960" aria-label="Send message">
        <path d="M120-160v-640l760 320-760 320Zm80-120 474-200-474-200v140l240 60-240 60v140Zm0 0v-400 400Z" />
      </svg></button>
  </footer>
  <input type="hidden" id="slug" value="{{slug}}" />
  <input type="hidden" id="user" value="{{currentUser}}" />
  <input type="hidden" id="first-msg-id" value="{{firstMsgId}}" />
  <input type="hidden" id="utc-offset" value="{{utcOffset}}" />
</main>
<script src="/script.mjs" async type="module"></script>